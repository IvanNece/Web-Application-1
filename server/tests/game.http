###
# ========================================
# TEST SUITE: API GAMEPLAY COMPLETE
# ========================================
# 
# Collection completa per testare tutte le API di gioco
# Include flussi autenticati e guest con scenari realistici
# Variabili dinamiche per workflow automatizzato
###

@host = http://localhost:3001

### SETUP: Login utente con monete sufficienti
POST {{host}}/api/sessions
Content-Type: application/json

{ "username": "novice", "password": "NoviceUser123!" }

### TEST: Creazione nuova partita autenticata
# @name createAuthGame
POST {{host}}/api/games

@authGameId = {{createAuthGame.response.body.gameId}}

### TEST: Recupero stato partita corrente
GET {{host}}/api/games/{{authGameId}}

### TEST: Tentativo lettera frequente (costo alto)
POST {{host}}/api/games/{{authGameId}}/guess-letter
Content-Type: application/json

{ "letter": "T" }

### TEST: Tentativo lettera duplicata (deve essere gratuita)
POST {{host}}/api/games/{{authGameId}}/guess-letter
Content-Type: application/json

{ "letter": "T" }

### TEST: Tentativo vocale (costo 10, solo una per partita)
POST {{host}}/api/games/{{authGameId}}/guess-letter
Content-Type: application/json

{ "letter": "a" }

### LETTERA SBAGLIATA (miss) → costo raddoppiato
POST {{host}}/api/games/{{authGameId}}/guess-letter
Content-Type: application/json

{ "letter": "z" }

### TENTA FRASE SBAGLIATA (nessuna penalità)
POST {{host}}/api/games/{{authGameId}}/guess-phrase
Content-Type: application/json

{ "attempt": "not the sentence" }

### ABBANDONA (fine senza penalità)
POST {{host}}/api/games/{{authGameId}}/abandon

### COSTI LETTERE
GET {{host}}/api/meta/letter-costs

### LETTERA FREQUENTE (usa sempre l'host, header e riga vuota prima del body)
POST {{host}}/api/games/{{authGameId}}/guess-letter
Content-Type: application/json

{ "letter": "t" }



### --- MODALITÀ GUEST (nessun login) ---

### TEST: Creazione partita guest (senza autenticazione)
# @name createGuestGame
POST {{host}}/api/guest/games

@guestGameId = {{createGuestGame.response.body.gameId}}

### STATO guest
GET {{host}}/api/guest/games/{{guestGameId}}

### LETTERA guest (costo 0, vocali libere)
POST {{host}}/api/guest/games/{{guestGameId}}/guess-letter
Content-Type: application/json

{ "letter": "e" }

### FRASE guest (sbagliata → nessuna penalità)
POST {{host}}/api/guest/games/{{guestGameId}}/guess-phrase
Content-Type: application/json

{ "attempt": "wrong sentence" }

### ABBANDONA guest
POST {{host}}/api/guest/games/{{guestGameId}}/abandon
